appGeneral.controller("ProfessorCtrl", function ($rootScope, $window, $interval, $scope, $state, $stateParams, $http, notify, orderByFilter, ServerRequests, Upload) {
	console.log("Controller professor loaded.");
	$scope.hello = "";
	$rootScope.titleHTML = " :: Professor";
	$scope.professor = {};
	$scope.tela = "";
	$scope.valueExpand = 0;
	$scope.progressCircularShow = false;
	$scope.progressBarShow = false;

	if ($stateParams.professor) {
		$scope.professor = $stateParams.professor;
		$window.sessionStorage.setItem("iProfessor", JSON.stringify($scope.professor));
	} else if ($window.sessionStorage.getItem("iProfessor")) {
		$scope.professor = JSON.parse($window.sessionStorage.getItem("iProfessor"));
		$window.sessionStorage.setItem("iProfessor", JSON.stringify($scope.professor));
	}


	$scope.novo = function () {
		$scope.professor = {};
		$window.sessionStorage.removeItem("iProfessor");
	}

	$scope.onFormSubmit = function () {
		$scope.progressCircularShow = true;
		console.log(JSON.stringify($scope.professor));
		ServerRequests.post('api/professor', JSON.stringify($scope.professor), "Commiting Product...").then(
			function (content) {
                console.log("Insert Success!");
                $scope.professor = content;
                notify({
                       messageTemplate: '<span>Professor salvo com sucesso</span>',
                       templateUrl:'',
                       classes: "alert-sucess",
                       position: "center",
                       duration: 3000
                     });
			}).finally(function () {
				$scope.progressCircularShow = false;
			});
	}

	$scope.excluirProfessor = function(professor){
		if(window.confirm("Você tem certeza que deseja excluir o Professor "+professor.nome+" ?")){
			$scope.progressCircularShow = true;
			console.log(JSON.stringify($scope.professor));
			ServerRequests.delete('api/professor/'+professor.id, {}, "Deleting Product...").then(
				function (content) {
					console.log("Processing Result");
                     notify({
                       messageTemplate: '<span>Professor Excluído com sucesso</span>',
                       templateUrl:'',
                       classes: "alert-sucess",
                       position: "center",
                       duration: 3000
                     });

				}).finally(function () {
					$scope.progressCircularShow = false;
				});
		}
	}

	console.log("Session loading");
});

appGeneral.controller("ProfessoresCtrl", function ($rootScope, $window, $interval, $scope, $state, $stateParams, $http, $translate, notify, orderByFilter, ServerRequests) {
	console.log("Controller professor loaded.");
	$window.sessionStorage.removeItem("iProfessor")
	$scope.hello = "";
	$rootScope.titleHTML = " :: Professores";
	$scope.professores = [];
	$scope.propertyName = 'nome';
	$scope.reverse = false;
	$scope.letterSelected = '';
	$scope.pagLetter = [];
	$scope.searchText = "";
	$scope.searchStatus = "";
	$scope.valueExpand = 0;
	$scope.progressBarShow = true;

	$scope.progressBar = $interval(function () {
		$scope.valueExpand++;
		if ($scope.valueExpand > 100) {
			$scope.valueExpand = 99;
			$interval.cancel($scope.progressBar);
		}
	}, 600);

	$scope.carregarDados = function () {
		ServerRequests.get('api/professor', {}, "Professores Loaded").then(
			function (content) {
				$scope.valueExpand = 50
				console.log("Processing Result");
					console.log("Query Success!");
					var professores = content;
					$scope.professores = [];
					$scope.pagLetter = [];
					$scope.valueExpand = 85;
					$scope.professores = orderByFilter(professores, $scope.propertyName, $scope.reverse);
					var pLetter = orderByFilter(professores, 'nome', $scope.reverse);
					var valor = "";
					for (i = 0; i < pLetter.length; i++) {
						if (pLetter[i].nome.substring(0, 1) != valor) {
							$scope.pagLetter.push(pLetter[i].nome.substring(0, 1));
							valor = pLetter[i].nome.substring(0, 1);
						}
					}
					$scope.valueExpand = 97;
			}).finally(function () {
				$scope.valueExpand = 97;
				$interval.cancel($scope.progressBar);
				$scope.progressBarShow = false;
			});
	};


	$scope.carregarDados();

	//Função para filtrar por letra.
	$scope.abrir = function (letra) {
		$scope.letterSelected = letra;
		$scope.professores = orderByFilter($scope.professores, $scope.propertyName, $scope.reverse);
	}

	//Função para organizar as colunas
	$scope.sortBy = function (propertyName) {
		$scope.reverse = (propertyName !== null && $scope.propertyName === propertyName)
			? !$scope.reverse : false;
		$scope.propertyName = propertyName;
		$scope.professores = orderByFilter($scope.professores, $scope.propertyName, $scope.reverse);
	};

	$scope.excluir = function(professor){
		if(window.confirm("Você tem certeza que deseja excluir o Professor "+professor.nome+" ?")){
			$scope.progressCircularShow = true;
			console.log(JSON.stringify($scope.professor));
			ServerRequests.delete('app/professor/'+professor.id, {}, "Deleting Professor...").then(
				function (content) {
					console.log("Processing Result");
					if (content.status == "OK") {
						$state.reload();
					}
				}).finally(function () {
					$scope.progressCircularShow = false;
				});
		}
	}
});


appGeneral.controller("TurmaCtrl", function ($rootScope, $window, $interval, $scope, $state, $stateParams, $http, notify, orderByFilter, ServerRequests, Upload) {
	console.log("Controller turma loaded.");
	$scope.hello = "";
	$rootScope.titleHTML = " :: Turma";
	$scope.turma = {};
    $scope.turma.alunos = [];
	$scope.tela = "";
	$scope.valueExpand = 0;
	$scope.progressCircularShow = false;
	$scope.progressBarShow = false;
	$scope.alunos = [];
	$scope.professores = [];
	$scope.aluno = {}

	if ($stateParams.turma) {
		$scope.turma = $stateParams.turma;
		$scope.progressCircularShow = true;

		ServerRequests.get('api/turmas/'+$scope.turma.codigo, {}, "Turma Loaded").then(
        			function (content) {
        				$scope.valueExpand = 50
        				console.log("Processing Result");
        					console.log("Query Success!");
        					$scope.turma = content;
        			}).finally(function () {
        					$scope.progressCircularShow = false;
        			});
		$window.sessionStorage.setItem("iTurma", JSON.stringify($scope.turma));
	} else if ($window.sessionStorage.getItem("iTurma")) {
		$scope.turma = JSON.parse($window.sessionStorage.getItem("iTurma"));
		$window.sessionStorage.setItem("iTurma", JSON.stringify($scope.turma));
	}

       $scope.carregarProfessores = function () {
		ServerRequests.get('api/professor', {}, "Professores Loaded").then(
			function (content) {
				$scope.valueExpand = 50
				console.log("Processing Result");
					console.log("Query Success!");
					var professores = content;
					$scope.professores = [];
					$scope.pagLetter = [];
					$scope.valueExpand = 85;
					$scope.professores = orderByFilter(professores, $scope.propertyName, $scope.reverse);
					var pLetter = orderByFilter(professores, 'nome', $scope.reverse);
					var valor = "";
					for (i = 0; i < pLetter.length; i++) {
						if (pLetter[i].nome.substring(0, 1) != valor) {
							$scope.pagLetter.push(pLetter[i].nome.substring(0, 1));
							valor = pLetter[i].nome.substring(0, 1);
						}
					}
					$scope.valueExpand = 97;
			}).finally(function () {
				$scope.valueExpand = 97;
				$interval.cancel($scope.progressBar);
				$scope.progressBarShow = false;
			});
	};

	$scope.carregarAlunos = function () {
    		ServerRequests.get('api/alunos', {}, "Alunos Loaded").then(
    			function (content) {
    				$scope.valueExpand = 50
    				console.log("Processing Result");
    					console.log("Query Success!");
    					var alunos = content;
    					$scope.alunos = [];
    					$scope.pagLetter = [];
    					$scope.valueExpand = 85;
    					$scope.alunos = orderByFilter(alunos, $scope.propertyName, $scope.reverse);
    					var pLetter = orderByFilter(alunos, 'nome', $scope.reverse);
    					var valor = "";
    					for (i = 0; i < pLetter.length; i++) {
    						if (pLetter[i].nome.substring(0, 1) != valor) {
    							$scope.pagLetter.push(pLetter[i].nome.substring(0, 1));
    							valor = pLetter[i].nome.substring(0, 1);
    						}
    					}
    					$scope.valueExpand = 97;
    			}).finally(function () {
    				$scope.valueExpand = 97;
    				$interval.cancel($scope.progressBar);
    				$scope.progressBarShow = false;
    			});
    	};

    		$scope.pesquisarAluno = function () {
            		ServerRequests.get('api/alunos/'+$scope.aluno.id, {}, "Aluno Loaded").then(
            			function (content) {
            				$scope.valueExpand = 50
            				console.log("Processing Result");
            					console.log("Query Success!");
            					var aluno = content;
            					$scope.aluno = aluno;
            			}).finally(function () {
            				$scope.valueExpand = 97;
            				$interval.cancel($scope.progressBar);
            				$scope.progressBarShow = false;
            			});
            	};


    $scope.carregarAlunos();
	$scope.carregarProfessores();


	$scope.novo = function () {
		$scope.turma = {};
		$window.sessionStorage.removeItem("iTurma");
	}

    $scope.limparItem = function () {
            $scope.aluno = {};
    }

    $scope.adicionaritem = function (){
        $scope.progressCircularShow = true;
        if($scope.turma.id > 0){
        var novoAluno = {"aluno":$scope.aluno.id, "turma":$scope.turma.id}
        ServerRequests.post('api/turmas/aluno', JSON.stringify(novoAluno), "Commiting Alunos Turma...").then(
            function (content) {
                console.log("Insert Success!");
                $scope.turma = content;
                notify({
                       messageTemplate: '<span>Turma salva com sucesso</span>',
                       templateUrl:'',
                       classes: "alert-sucess",
                       position: "center",
                       duration: 3000
                     });
            }).finally(function () {
                $scope.progressCircularShow = false;
            });
        }else{
                var novoAluno = {"aluno":$scope.aluno.id}
                $scope.turma.alunos.push(novoAluno);
                $scope.progressCircularShow = false;
        }
}

	$scope.onFormSubmit = function () {
		$scope.progressCircularShow = true;
		console.log(JSON.stringify($scope.turma));
		ServerRequests.post('api/turmas', JSON.stringify($scope.turma), "Commiting Turma...").then(
			function (content) {
                console.log("Insert Success!");
                $scope.turma = content;
                notify({
                       messageTemplate: '<span>Turma salva com sucesso</span>',
                       templateUrl:'',
                       classes: "alert-sucess",
                       position: "center",
                       duration: 3000
                     });
			}).finally(function () {
				$scope.progressCircularShow = false;
			});
	}

	$scope.excluirTurma = function(turma){
		if(window.confirm("Você tem certeza que deseja excluir o Turma "+turma.nome+" ?")){
			$scope.progressCircularShow = true;
			console.log(JSON.stringify($scope.turma));
			ServerRequests.delete('api/turmas/'+turma.id, {}, "Deleting Turma...").then(
				function (content) {
					console.log("Processing Result");
                     notify({
                       messageTemplate: '<span>Turma Excluído com sucesso</span>',
                       templateUrl:'',
                       classes: "alert-sucess",
                       position: "center",
                       duration: 3000
                     });
                     state.go("turmas");
				}).finally(function () {
					$scope.progressCircularShow = false;
				});
		}
	}

	console.log("Session loading");
});


appGeneral.controller("AlunoCtrl", function ($rootScope, $window, $interval, $scope, $state, $stateParams, $http, notify, orderByFilter, ServerRequests, Upload) {
	console.log("Controller aluno loaded.");
	$scope.hello = "";
	$rootScope.titleHTML = " :: Aluno";
	$scope.aluno = {};
	$scope.tela = "";
	$scope.valueExpand = 0;
	$scope.progressCircularShow = false;
	$scope.progressBarShow = false;

	if ($stateParams.aluno) {
		$scope.aluno = $stateParams.aluno;
		$window.sessionStorage.setItem("iAluno", JSON.stringify($scope.aluno));
	} else if ($window.sessionStorage.getItem("iAluno")) {
		$scope.aluno = JSON.parse($window.sessionStorage.getItem("iAluno"));
		$window.sessionStorage.setItem("iAluno", JSON.stringify($scope.aluno));
	}


	$scope.novo = function () {
		$scope.aluno = {};
		$window.sessionStorage.removeItem("iAluno");
	}

	$scope.onFormSubmitAluno = function () {
		$scope.progressCircularShow = true;
		console.log(JSON.stringify($scope.aluno));
		ServerRequests.post('api/alunos', JSON.stringify($scope.aluno), "Commiting Turma...").then(
			function (content) {
                console.log("Insert Success!");
                $scope.aluno = content;
                notify({
                       messageTemplate: '<span>Aluno salvo com sucesso</span>',
                       templateUrl:'',
                       classes: "alert-sucess",
                       position: "center",
                       duration: 3000
                     });
			}).finally(function () {
				$scope.progressCircularShow = false;
			});
	}

	$scope.excluirAluno = function(aluno){
		if(window.confirm("Você tem certeza que deseja excluir o Aluno "+aluno.nome+" ?")){
			$scope.progressCircularShow = true;
			console.log(JSON.stringify($scope.aluno));
			ServerRequests.delete('api/alunos/'+aluno.id, {}, "Deleting Turma...").then(
				function (content) {
					console.log("Processing Result");
                     notify({
                       messageTemplate: '<span>Aluno Excluído com sucesso</span>',
                       templateUrl:'',
                       classes: "alert-sucess",
                       position: "center",
                       duration: 3000
                     });
                     state.go("alunos");
				}).finally(function () {
					$scope.progressCircularShow = false;
				});
		}
	}

	console.log("Session loading");
});

appGeneral.controller("AlunosCtrl", function ($rootScope, $window, $interval, $scope, $state, $stateParams, $http, $translate, notify, orderByFilter, ServerRequests) {
	console.log("Controller aluno loaded.");
	$window.sessionStorage.removeItem("iAluno")
	$scope.hello = "";
	$rootScope.titleHTML = " :: Alunos";
	$scope.alunos = [];
	$scope.propertyName = 'nome';
	$scope.reverse = false;
	$scope.letterSelected = '';
	$scope.pagLetter = [];
	$scope.searchText = "";
	$scope.searchStatus = "";
	$scope.valueExpand = 0;
	$scope.progressBarShow = true;

	$scope.progressBar = $interval(function () {
		$scope.valueExpand++;
		if ($scope.valueExpand > 100) {
			$scope.valueExpand = 99;
			$interval.cancel($scope.progressBar);
		}
	}, 600);

	$scope.carregarDados = function () {
		ServerRequests.get('api/alunos', {}, "Alunos Loaded").then(
			function (content) {
				$scope.valueExpand = 50
				console.log("Processing Result");
					console.log("Query Success!");
					var alunos = content;
					$scope.alunos = [];
					$scope.pagLetter = [];
					$scope.valueExpand = 85;
					$scope.alunos = orderByFilter(alunos, $scope.propertyName, $scope.reverse);
					var pLetter = orderByFilter(alunos, 'nome', $scope.reverse);
					var valor = "";
					for (i = 0; i < pLetter.length; i++) {
						if (pLetter[i].nome.substring(0, 1) != valor) {
							$scope.pagLetter.push(pLetter[i].nome.substring(0, 1));
							valor = pLetter[i].nome.substring(0, 1);
						}
					}
					$scope.valueExpand = 97;
			}).finally(function () {
				$scope.valueExpand = 97;
				$interval.cancel($scope.progressBar);
				$scope.progressBarShow = false;
			});
	};


	$scope.carregarDados();

	//Função para filtrar por letra.
	$scope.abrir = function (letra) {
		$scope.letterSelected = letra;
		$scope.alunos = orderByFilter($scope.alunos, $scope.propertyName, $scope.reverse);
	}

	//Função para organizar as colunas
	$scope.sortBy = function (propertyName) {
		$scope.reverse = (propertyName !== null && $scope.propertyName === propertyName)
			? !$scope.reverse : false;
		$scope.propertyName = propertyName;
		$scope.alunos = orderByFilter($scope.alunos, $scope.propertyName, $scope.reverse);
	};

	$scope.excluir = function(aluno){
		if(window.confirm("Você tem certeza que deseja excluir o Aluno "+aluno.nome+" ?")){
			$scope.progressCircularShow = true;
			console.log(JSON.stringify($scope.aluno));
			ServerRequests.delete('api/alunos/'+aluno.id, {}, "Deleting Aluno...").then(
				function (content) {
					console.log("Processing Result");
                     notify({
                       messageTemplate: '<span>Aluno Excluído com sucesso</span>',
                       templateUrl:'',
                       classes: "alert-sucess",
                       position: "center",
                       duration: 3000
                     });
                     $state.reload();

				}).finally(function () {
					$scope.progressCircularShow = false;
				});
		}
	}
});


appGeneral.controller("TurmasCtrl", function ($rootScope, $window, $interval, $scope, $state, $stateParams, $http, $translate, notify, orderByFilter, ServerRequests) {
	console.log("Controller turma loaded.");
	$window.sessionStorage.removeItem("iTurma")
	$scope.hello = "";
	$rootScope.titleHTML = " :: Turmas";
	$scope.turmaslista = [];
	$scope.propertyName = 'nomeTurma';
	$scope.reverse = false;
	$scope.letterSelected = '';
	$scope.pagLetter = [];
	$scope.searchText = "";
	$scope.searchStatus = "";
	$scope.valueExpand = 0;
	$scope.progressBarShow = true;

	$scope.progressBar = $interval(function () {
		$scope.valueExpand++;
		if ($scope.valueExpand > 100) {
			$scope.valueExpand = 99;
			$interval.cancel($scope.progressBar);
		}
	}, 600);

	$scope.carregarDados = function () {
		ServerRequests.get('api/turmas', {}, "Turmas Loaded").then(
			function (content) {
				$scope.valueExpand = 50
				console.log("Processing Result");
				    var turmas = content;
					$scope.turmas = turmas;
					$scope.pagLetter = [];
					$scope.valueExpand = 85;
					var pLetter = orderByFilter(turmas, 'nomeTurma', false);
					console.log("Query Success!");
					var valor = "";
					for (i = 0; i < pLetter.length; i++) {
						if (pLetter[i].nomeTurma.substring(0, 1) != valor) {
							$scope.pagLetter.push(pLetter[i].nomeTurma.substring(0, 1));
							valor = pLetter[i].nomeTurma.substring(0, 1);
						}
					}
					$scope.valueExpand = 97;
			}).finally(function () {
				$scope.valueExpand = 97;
				$interval.cancel($scope.progressBar);
				$scope.progressBarShow = false;
				console.log("Finished");
			});
	};

	$scope.carregarDados();

	//Função para filtrar por letra.
	$scope.abrir = function (letra) {
		$scope.letterSelected = letra;
		$scope.turmas = orderByFilter($scope.turmas, $scope.propertyName, $scope.reverse);
	}

	//Função para organizar as colunas
	$scope.sortBy = function (propertyName) {
		$scope.reverse = (propertyName !== null && $scope.propertyName === propertyName)
			? !$scope.reverse : false;
		$scope.propertyName = propertyName;
		$scope.turmas = orderByFilter($scope.turmas, $scope.propertyName, $scope.reverse);
	};

	$scope.excluir = function(turma){
		if(window.confirm("Você tem certeza que deseja excluir o Turma "+turma.nome+" ?")){
			$scope.progressCircularShow = true;
			ServerRequests.delete('api/turmas/'+turma.id, {}, "Deleting Turma...").then(
				function (content) {
					console.log("Processing Result");
                     notify({
                       messageTemplate: '<span>Turma Excluído com sucesso</span>',
                       templateUrl:'',
                       classes: "alert-sucess",
                       position: "center",
                       duration: 3000
                     });
                     $state.reload();

				}).finally(function () {
					$scope.progressCircularShow = false;
				});
		}
	}
});



appGeneral.controller("DashCtrl", function($rootScope, $window, $scope, $state, $translate, notify, $http) {
	console.log("Controller dashboard loaded");
});

appGeneral.controller("OwnerCtrl", function($rootScope, $window, $scope, $state, $http, $translate, notify) {
	console.log("Controller owner loaded");
	$scope.hello = "";
	var date = new Date();
	var hour = date.getHours();
	$scope.usuario = JSON.parse($window.sessionStorage.getItem("hUsuario"));

	$translate('DASHBOARD.TITLE').then(function (headline) {
		$rootScope.titleHTML = headline;
	});

	$translate('GREETINGS.HI').then(function (greetings) {
		$scope.hello  = greetings;
	});

	if(hour >= 0 && hour <= 12){
	$translate('GREETINGS.MORNING').then(function (greetings) {
		$scope.hello  = greetings;
	});

	}
	if(hour > 12 && hour <= 18){
		$translate('GREETINGS.AFTERNOON').then(function (greetings) {
			$scope.hello  = greetings;
		});
	}
	if(hour > 18 && hour <= 24){
		$translate('GREETINGS.NIGHT').then(function (greetings) {
			$scope.hello  = greetings;
		});
	}

});